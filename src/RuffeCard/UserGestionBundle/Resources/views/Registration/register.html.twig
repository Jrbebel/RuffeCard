{% extends "RuffeCardUserGestionBundle:Administrateur:Menu.html.twig" %}
{% block title %}Gestion des Employes{% endblock %} {% block corp %}

<div class="panel panel-primary" id="registerCorps">
	<div class="panel-heading" id="clientNewPanel">
		<h2 class="panel-title">
		{% if Type=='1'%}
			{{('<span class="fa	fa-smile-o"></span>')}}
		{% else %}{{('<span class="fa fa-suitcase"></span>')}}
		{% endif %} 
			
			
			{% if Method=='new'%}{{('Formulaire d\'ajout de nouveaux')}}{% else
			%}{{('Formulaire de modification des')}}{% endif %}
			
			{% if Type=='1'%}{{('commerciaux')}}{% else
			%}{{('managers')}}{% endif %}</h2>

	</div>

	<form   {{ form_enctype(form) }} method="POST"
		class="fos_user_registration_register form-horizontal">
		<fieldset>
			<div class="col-md-12">
				<div class="row" id="rowObjectif">
					<div class="col-md-6"></div>
				</div>

				<!-- PERSONNE -->
				<div class="col-md-6">
					<div class="panel panel-info" id="objectifPanelDashboard">
						<div class="panel-heading">
							<h3 class="panel-title">
								<span class="fa fa-user"></span> Personne
							</h3>
						</div>
						<div class="panel-body" id="objectiftifDashboard">
							<div class="row" id="corpsObjectifDashboard">
								<div class="form-group">
									<label class="col-lg-6 control-label">Username</label>
									<div class="col-lg-6">{{ form_errors(form.username) }} {{
										form_widget(form.username) }}</div>
								</div>
								<div class="form-group">
									<label class="col-lg-6 control-label">Nom</label>
									<div class="col-lg-6">{{ form_errors(form.nom) }} {{
										form_widget(form.nom) }}</div>
								</div>
								<div class="form-group">
									<label class="col-lg-6 control-label">Prenom</label>
									<div class="col-lg-6">{{ form_errors(form.prenom) }} {{
										form_widget(form.prenom) }}</div>
								</div>
								<div class="form-group">
									<label class="col-lg-6 control-label">Age</label>
									<div class="col-lg-6">{{ form_errors(form.age) }} {{
										form_widget(form.age) }}</div>
								</div>
								<div class="form-group">
									<label class="col-lg-6 control-label">Date de naissance</label>
									<div class="col-lg-6">{{ form_errors(form.dayBirth) }} {{
										form_widget(form.dayBirth) }}</div>
								</div>
								<div class="form-group">
									<label class="col-lg-6 control-label">Sex</label>
									<div class="col-lg-6">{{ form_errors(form.sexe) }} {{
										form_widget(form.sexe) }}</div>
								</div>

							</div>
						</div>
					</div>
				</div>

				<!-- LOGIN / MDP -->
				<div class="col-md-6">
					<div class="panel panel-danger" id="objectifPanelDashboard">
						<div class="panel-heading">
							<h3 class="panel-title">
								<span class="fa fa-lock"></span> Connexion
							</h3>
						</div>
						<div class="panel-body" id="objectiftifDashboard">
							<div class="row" id="corpsObjectifDashboard">

								<div class="form-group">
									<label class="col-lg-6 control-label">Login</label>
									<div class="col-lg-6">{{ form_errors(form.username) }} {{
										form_widget(form.username) }}</div>
								</div>

								<div class="form-group">
									<label class="col-lg-6 control-label"><i class="fa fa-lock"></i></label>
									<div class="col-lg-6 connexionNew">{{
										form_errors(form.plainPassword) }} {{
										form_widget(form.plainPassword) }}</div>
								</div>

							</div>
						</div>
					</div>
				</div>

				<!-- CONTACT -->
				<div class="col-md-12">
					<div class="panel panel-success" id="objectifPanelDashboard">
						<div class="panel-heading">
							<h3 class="panel-title">
								<span class="fa fa-globe"></span> Moyen de contact
							</h3>
						</div>
						<div class="panel-body" id="objectiftifDashboard">
							<div class="row" id="corpsObjectifDashboard">
								<div class="col-md-6">
									<div class="form-group">
										<label class="col-lg-3 control-label">Email</label>
										<div class="col-lg-3">{{ form_errors(form.email) }} {{
											form_widget(form.email) }}</div>
									</div>

									<div class="form-group">
										<label class="col-lg-3 control-label">Tel fixe</label>
										<div class="col-lg-3">{{ form_errors(form.telFixe) }} {{
											form_widget(form.telFixe) }}</div>
									</div>

									<div class="form-group">
										<label class="col-lg-3 control-label">Tel Port1</label>
										<div class="col-lg-3">{{ form_errors(form.portable1) }} {{
											form_widget(form.portable1) }}</div>
									</div>
									<div class="form-group">
										<label class="col-lg-3 control-label">Tel Port2</label>
										<div class="col-lg-3">{{ form_errors(form.portable2) }} {{
											form_widget(form.portable2) }}</div>
									</div>
									<div class="form-group">
										<label class="col-lg-3 control-label">Tel Port3</label>
										<div class="col-lg-3">{{ form_errors(form.portable3) }} {{
											form_widget(form.portable3) }}</div>
									</div>
								</div>

								<div class="col-md-6">
									<div class="form-group">
										<label class="col-lg-2 control-label"><i
											class="fa fa-facebook"></i></label>
										<div class="col-lg-4">{{ form_errors(form.twitter) }} {{
											form_widget(form.twitter) }}</div>
									</div>
									<div class="form-group">
										<label class="col-lg-2 control-label"><i class="fa fa-twitter"></i></label>
										<div class="col-lg-4">{{ form_errors(form.googleplus) }} {{
											form_widget(form.googleplus) }}</div>
									</div>
									<div class="form-group">
										<label class="col-lg-2 control-label"><i
											class="fa fa-google-plus"></i></label>
										<div class="col-lg-4">{{ form_errors(form.facebook) }} {{
											form_widget(form.facebook) }}</div>
									</div>
								</div>
							</div>
						</div>
					</div>
					<div class="row" id="corpsEntreprisePanel">

						<div class="col-md-12">
							<div class="row" id="rowObjectif">
								<div class="col-md-12">
									<div class="panel panel-warning" id="objectifPanelDashboard">
										<div class="panel-heading">
											<h3 class="panel-title">
												<span class="fa fa-map-marker"></span> Adresse
											</h3>
										</div>
										<div class="panel-body" id="objectiftifDashboard">
											<div class="row" id="corpsObjectifDashboard">

												<div class="col-md-5 adresseForm" id="ajout_adresse">

													<div class="form-group">{{ form_widget(form) }}</div>

												</div>
											</div>

										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
{# 			/**********Le champs input a mettre en forme,permet l autocompletion*****/#}
					<div><label for="ruffecard_usergestionbundle_user_Commercial" class="required">Commercial</label>
		<input type="text" id="ruffecard_usergestionbundle_user_Commercial" name="ruffecard_usergestionbundle_user[Commercial]" class="form-control"></div>		
			
{# 			/**************/		#}
					
					
				</div>

				
    <input type="hidden" id="commercial" name="commercial" />
      
				<input type="hidden" id="type" name="Type" value= {{ Type }} /> {{
				form_rest(form) }}
			</div>

			{{ form_widget(form) }} <br>
			<button class="btn btn-primary" type="submit"
				value="{{ 'registration.submit'|trans({}, 'FOSUserBundle') }}">Ajouter</button>
		</fieldset>
		<input type="hidden" id="type" name="Type" value= {{ Type }} />
	</form>
</div>

{% endblock corp %} {% block javascripts %} {# On charge la bibliothèque
jQuery. Ici, je la prends depuis le site jquery.com, 12 mais si vous
l'avez en local, changez simplement l'adresse. #}
<script src="http://code.jquery.com/jquery-1.8.2.min.js"></script>

{# Voici le script en question : #}
<script type="text/javascript">
$(document).ready(function() {
	
  // On récupère la balise <div> en question qui contient l'attribut « data-prototype » qui nous intéresse.
  var $container = $('div#ruffecard_usergestionbundle_user_adresse');
  
 // On ajoute un lien pour ajouter une nouvelle catégorie
  var $lienAjout = $('<a href="#" id="ajout_adresse" class="btn btn-info">Ajouter l\'adresse d\'autre enseigne</a>');
  $container.append($lienAjout);

  // On ajoute un nouveau champ à chaque clic sur le lien d'ajout.
  $lienAjout.click(function(e) {
    ajouterAdresse($container);
    e.preventDefault(); // évite qu'un # apparaisse dans l'URL
    return false;
      });

  // On définit un compteur unique pour nommer les champs qu'on va ajouter dynamiquement
 var index = $container.find(':input').length;

  // On ajoute un premier champ directement s'il n'en existe pas déjà un (cas d'un nouvel article par exemple).
  if (index == 0) {
    ajouterAdresse($container);
  } else {
   // Pour chaque catégorie déjà existante, on ajoute un lien de suppression
    $container.children('div').each(function() {
      ajouterLienSuppression($(this));
    });
  }

  // La fonction qui ajoute un formulaire Categorie
  function ajouterAdresse($container) {
    // Dans le contenu de l'attribut « data-prototype », on remplace :
    // - le texte "__name__label__" qu'il contient par le label du champ
    // - le texte "__name__" qu'il contient par le numéro du champ
    var $prototype = $($container.attr('data-prototype').replace(/__name__label__/g, 'Adresse n°' + (index+1))
                                                        .replace(/__name__/g, index));

    // On ajoute au prototype un lien pour pouvoir supprimer la catégorie
    ajouterLienSuppression($prototype);

    // On ajoute le prototype modifié à la fin de la balise <div>
    $container.append($prototype);

    // Enfin, on incrémente le compteur pour que le prochain ajout se fasse avec un autre numéro
    index++;
  }

  // La fonction qui ajoute un lien de suppression d'une categorie
  function ajouterLienSuppression($prototype) {
    // Création du lien
    $lienSuppression = $('<a href="#" class="btn btn-danger">Supprimer</a>');

    // Ajout du lien
    $prototype.append($lienSuppression);

    // Ajout du listener sur le clic du lien
    $lienSuppression.click(function(e) {
      $prototype.remove();
      e.preventDefault(); // évite qu'un # apparaisse dans l
      return false;
    });
  }
});
</script>
  <script type="text/javascript" src="{{ asset('js/jquery-1.8.0.min.js') }}"></script>
               <script type="text/javascript" src="{{ asset('js/jquery.ui.widget.js') }}"></script>
       <script type="text/javascript" src="{{ asset('js/jquery.ui.autocomplete.js') }}"></script>
               <script type="text/javascript" src="{{ asset('js/jquery.ui.core.js') }}"></script>
                       <script type="text/javascript" src="{{ asset('js/jquery.ui.position.js') }}"></script>
                               <script type="text/javascript" src="{{ asset('js/jquery-ui-1.8.23.custom.min.js') }}"></script>
<script type="text/javascript">

$(document).ready(function () {

    $("input#ruffecard_usergestionbundle_user_Commercial").autocomplete({
        source: function (request, response) {
            var motcle = $('input#ruffecard_usergestionbundle_user_Commercial').val();
            var DATA = 'motcle=' + motcle;
            $.ajax({
                url: "{{ path('Admin_search_commercial') }}", 
                type: "POST", 
                dataType: "json",
                data: DATA,
                success: function (data) {
                      
                    response($.map(data, function (item,i) {
                        return { 
                            label: item, 
                            value: i,
                            id:i
                            }
                    }))
                }
            })
        },
        select: function (event, ui) {
console.log(ui.item);
            $('input#ruffecard_usergestionbundle_user_Commercial').val( ui.item.id);
        
        },
        change: function (event, ui) {
        
            $('input#ruffecard_usergestionbundle_user_Commercial').val(ui.item.id);

        }
    });

});


$(document).ready(function () {
		
	$( "select#ruffecard_usergestionbundle_user_Commercial" ).replaceWith( "" );
	
});

</script>


{% endblock %}
